<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>

<article xml:id="concept-systemd" xml:lang="en"
 role="concept"
 xmlns="http://docbook.org/ns/docbook" version="5.1"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">

 <info>
   <title>Basic &systemd; concepts</title>
   <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
    <dm:bugtracker>
     <dm:url>https://bugzilla.suse.com/enter_bug.cgi</dm:url>
     <dm:component>Smart Docs</dm:component>
     <dm:product>Documentation</dm:product>
     <dm:assignee>jsindelarova@suse.com</dm:assignee>
    </dm:bugtracker>
    <dm:translation>no</dm:translation>
   </dm:docmanager>
 </info>

 <section xml:id="environment-concept-slemicro-cloud">
  <title>Environment</title>
  <para>This document applies to the following products and product versions:</para>
  <itemizedlist>
   <listitem>
    <para>&slema;&nbsp;5.4, &slema;&nbsp;5.3, &slema;&nbsp;5.2</para>
   </listitem>
   </itemizedlist>
 </section>

<section xml:id="micro-cloud-introduction">
  <title>introduction</title>
  <para>
    This article provides details specific to &slema; images that are intended for deployment in public cloud environment. Generic information about Public Cloud images are provided in the <link xlink:href="https://documentation.suse.com/sle-public-cloud/all/html/public-cloud/public-cloud.html">Public Cloud Guide</link>.
  </para>
</section>
 

 <section xml:id="tools-slema-deployment">
  <title>Tools involved in initializing &slema; in public clouds</title>
  <para>
    The instance intialization is performed using &ignition; and Afterburn. In the default &ignition; configuration, &ignition; is responsible for creating the default user: <literal>suse</literal>. Afterburn passes the SSH key to the user's home directory using the instance metadata service (IMDS). 
  </para>
  <para>
    &ignition; runs on the first boot only. To distinquish the first boot from succeding boots, the flag file <filename>/boot/writable/firstboot_happened</filename> is created. Whenever you want to trigger &ignition; again, you need to remove this file.
  </para>
  <para>
    The default &ignition; configuration is stored in the configuration file: <filename>/usr/lib/ignition/base.d/base.ign</filename>. You can modify this file to perform configuration changes, for details, refer to <xref linkend="task-modifying-ignition-cloud"/>.
    </para>
    <note>
      <title>&combustion; not included in the &slema; Public Cloud images</title>
      <para>
        In order to configure your instance with &combustion;, you need to create a separate disk in the cloud framework. The disk needs to meet the necessary directory structure. Then you need to create an instance with this configuration disk attached. If the use of &combustion; is needed for integration into your environment you can build your own images using keg and keg-recipes. The keg-recipes project contains the image description SUSE uses to build the images we publish. For details, refer to <link xlink:href="https://github.com/SUSE-Enceladus/keg-recipes/">keg-recipes</link>.
      </para>
    </note>
 </section>

 
 <section xml:id="disk-size-clouds">
  <title>Required and available disk size</title>
  <para>
    The root volume is set to the size specified byt the cloud vendors, for example 10&nbsp;GB in AWS and GCE, and 30&nbsp;GB in Azure.
  </para>
  <para>
    The recommended size for &slema; is 12&nbsp;GB. However, the size depends on the number and size of workloads you intend to run.
  </para>
  <para>
    As with each run of the &tr-up; command a new snapshot is created, keep in mind that these snapshots also take some size, even though, btrfs snapshots are space efficient.
  </para>
  <para>
    The root volume automatically grows as you change the size of the underlying disk. When you are running low on disk space you can always stop your instance and make the system disk bigger, up to the limitation of individual disk sizes in each Cloud framework.
  </para>
 </section>

 <section xml:id="snapshots-cloud-vs-slema">
  <title>Snapshotting</title>
  <para>
    &slema; creates its own internal snapshot that are not related nor can interfere with the external snapshots of the disk that can be created using the Cloud framework tools for backup purposes or to create new images.
    For details about &slema; snapshots, refer to <link xlink:href="https://documentation.suse.com/sle-micro/html/SLE-Micro-all/cha-snapshots.html"></link>.
  </para>
 </section>

 <section xml:id="default-users">
  <title>Users of &slema;</title>
  <para>
    &slema; images comes with a predefined user <literal>suse</literal> that has <command>sudo</command> privileges assigned. Therefore, you can swith to the &rootuser; using the <command>sudo -i</command> command.
  </para> 
  <para>
    As the default user probably won't suit your needs, you have several options how to add users according to your needs. Either you can define users in the &ignition; configuration file or you can use the <command>useradd</command> command to add users to the running system.
  </para>
  <para>
    For details regarding adding users via &ignition;, refer to <link xlink:href="https://documentation.suse.com/sle-micro/html/SLE-Micro-all/cha-images-ignition.html#sec-ignition-examples"></link> and <xref linkend="modifying-ignition-cnfiguration-cloud"/>. For details regarding using the <command>useradd</command> command, see <xref linkend="task-slemicro-useradd"/>.
  </para>

 </section>

 <section xml:id="related-systemd">
  <title>Related topics</title>
  <para>
    Because &systemd; is a complete process manager, from startup to
    shutdown, it controls all operations on a Linux system. Consult the
    following resources to learn more.
  </para>
  <itemizedlist>
   <listitem>
    <para>
      freedesktop is the home of &systemd;:
      <link xlink:href="https://www.freedesktop.org/wiki/Software/systemd/"/>
    </para>
   </listitem>
   <listitem>
    <para>
      Run <command>man -k systemd</command> to see all man pages for
      &systemd;. The following man pages are the most relevant for daily
      administration tasks:
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man 1 systemd</command>
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man 1 systemctl</command>
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man 1 journalctl</command>
    </para>
   </listitem>
  </itemizedlist>
 </section>
</article>
